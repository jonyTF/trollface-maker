<!DOCTYPE html>
<html>
    <head>
        <title>Trollface Maker</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="index.css">
        <link rel="stylesheet" type="text/css" href="https://www.w3schools.com/w3css/4/w3.css">
    </head>

    <body>
        <ul class="slideshow page" data-page-num="1">
            <li>
                <span>Image 1</span>
            </li>
            <li>
                <span>Image 2</span>
            </li>
        </ul>



        <div class="w3-container page" data-page-num="2">
            <form id="upload" action="javascript:void(0);" method="post" enctype="multipart/form-data">
                <input id="filetoupload" type="file" name="filetoupload" /><br>
                <input id="submitBtn" type="submit" />
            </form>

            <p id="display"></p>
        
        </div>

        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
        <script>
            function setPage(num) {
                var pages = $('.page');
                var i;
                for (i = 0; i < pages.length; i++) {
                    if (parseInt($(pages[i]).attr('data-page-num')) != num) {
                        $(pages[i]).hide();
                    }
                }
            }

            $('#upload').submit(function() {
                console.log('lel');
                $('#submitBtn').attr('disabled', 'disabled');

                var data = new FormData();
                var file = $('#filetoupload')[0].files[0];
                data.append('pic', file);

                fetch('../make_trollface', {
                    method: 'POST',
                    body: data
                })
                .then((response) => {return response.json()})
                .then((data) => {
                    window.location = '/img/' + data.filename;
                });
            });

            var page = 1;
            setPage(page);
        </script>
    </body>
</html>